<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/EventInvitation.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/thegroundwork/groundwork.js.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Auth.js~Auth.html">Auth</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Dictionary.js~Dictionary.html">Dictionary</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Donation.js~Donation.html">Donation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Event.js~Event.html">Event</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/EventCategory.js~EventCategory.html">EventCategory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/EventInvitation.js~EventInvitation.html">EventInvitation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/EventMessage.js~EventMessage.html">EventMessage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/EventTicket.js~EventTicket.html">EventTicket</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Groundwork.js~Groundwork.html">Groundwork</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Http.js~Http.html">Http</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Payment.js~Payment.html">Payment</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Profile.js~Profile.html">Profile</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Quickcard.js~Quickcard.html">Quickcard</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/SchemaUtils.js~SchemaUtils.html">SchemaUtils</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Subscription.js~Subscription.html">Subscription</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Supporter.js~Supporter.html">Supporter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-deprecate">deprecate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-epoch">epoch</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-has">has</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isApiVersion">isApiVersion</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isEmpty">isEmpty</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-max">max</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-mixin">mixin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-normalizeUrl">normalizeUrl</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-only">only</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-urlJoin">urlJoin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-validEmail">validEmail</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ENDPOINT_CATEGORY">ENDPOINT_CATEGORY</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ENDPOINT_EVENT">ENDPOINT_EVENT</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ENDPOINT_HOST_UNSUBSCRIBE">ENDPOINT_HOST_UNSUBSCRIBE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ENDPOINT_INVITATION">ENDPOINT_INVITATION</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ENDPOINT_MESSAGE">ENDPOINT_MESSAGE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ENDPOINT_TICKET">ENDPOINT_TICKET</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-NAMESPACE">NAMESPACE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-API_URL">API_URL</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-API_VERSION">API_VERSION</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-AUTH_ACCESS_TOKEN">AUTH_ACCESS_TOKEN</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-AUTH_GWID">AUTH_GWID</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-AUTH_TOKEN_TYPE">AUTH_TOKEN_TYPE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CONFIG_AUTH">CONFIG_AUTH</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-DEFAULT_API_URL">DEFAULT_API_URL</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-FACEBOOK_APP_ID">FACEBOOK_APP_ID</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-OAUTH_CLIENT_ID">OAUTH_CLIENT_ID</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-RE_API_VERSION">RE_API_VERSION</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/EventInvitation.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import { only, urlJoin } from &apos;./utils&apos;;
import { NAMESPACE, ENDPOINT_EVENT, ENDPOINT_INVITATION } from &apos;./Event&apos;;
import eventInvitationSchema from &apos;./schema/eventInvitation&apos;;

/** @type {Array} - Status options for Invitation RSVP&apos;s */
const STATUSES = [&apos;declined&apos;, &apos;pending&apos;];

/**
 * An EventInvitation is an email correspondence used to inform people of an event.
 *
 * @example
 * const gw = new Groundwork({...});
 *
 * // List all invitations, while passing in an optional config
 * gw.events.listInvitations({ status: &apos;pending&apos;, page: 2, perPage: 10 })
 *   .then((response) =&gt; console.log(response))
 *   .catch((err) =&gt; console.error(err));
 *
 * gw.events.fetchInvitation(&lt;event id&gt;, &lt;invitation id&gt;)
 *   .then((response) =&gt; console.log(response))
 *   .catch((err) =&gt; console.error(err));
 *
 * gw.events.createInvitation(&lt;event id&gt;, {...})
 *   .then((response) =&gt; console.log(response))
 *   .catch((err) =&gt; console.error(err));
 *
 * //
 * gw.events.updateInvitationStatus(&lt;event id&gt;, &lt;invitation id&gt;, &lt;status&gt;)
 *   .then((response) =&gt; console.log(response))
 *   .catch((err) =&gt; console.error(err));
 *
 * gw.events.delInvitation(&lt;event id&gt;, &lt;invitation id&gt;)
 *   .then((response) =&gt; console.log(response))
 *   .catch((err) =&gt; console.error(err));
 */
export default class EventInvitation {

  /**
   * If the status of an invitation is neither `declined` nor `pending` then send back a
   * tuple with a rejected Promise containing an error message.
   *
   * @param {String} status - status of the invitation
   * @return {Array}
   */
  validateStatus(status) {
    let out = [true];

    const valid = STATUSES.some(s =&gt; s === status);

    if (!valid) {
      const response = this.http.generateErrorResponse({
        valid: false,
        fields: [&apos;status&apos;],
        msg: [`Invalid status: ${status}. Options are \`declined\` or \`pending\``]
      });
      out = [false, Promise.reject(response)];
    }

    return out;
  }

  /**
   * List all invitations on an Event
   *
   * @param  {String} eventId - id of event
   * @param  {Object} [opts] - options object
   * @param {Number} [opts.page] -
   *   an Integer indicating which page of results should be returned
   * @param {Number} [opts.perPage] -
   *   an Integer indicating how many results should be returned per request
   * @param  {String} [opts.status] -
   *   the status by which you wish to filter. It may be accepted, declined, or pending
   * @return {Promise}
   */
  listInvitations(eventId, opts = {}) {
    const [ev, ep] = this.validateId(eventId, &apos;eventId&apos;);
    if (!ev) { return ep; }

    const _opts = only([&apos;page&apos;, &apos;perPage&apos;, &apos;status&apos;], opts);
    const url = urlJoin(NAMESPACE, ENDPOINT_EVENT, eventId,
                                   ENDPOINT_INVITATION);

    return this.http.get(url, { params: _opts });
  }

  /**
   * Get a specific Invitation, by id
   *
   * @param  {String} eventId - id of event
   * @param  {String} invitationId - id of invitation
   * @return {Promise}
   */
  fetchInvitation(eventId, invitationId) {
    const [ev, ep] = this.validateId(eventId, &apos;eventId&apos;);
    if (!ev) { return ep; }

    const [iv, ip] = this.validateId(invitationId, &apos;invitationId&apos;);
    if (!iv) { return ip; }

    const url = urlJoin(NAMESPACE, ENDPOINT_EVENT, eventId,
                                   ENDPOINT_INVITATION, invitationId);
    return this.http.get(url);
  }

  /**
   * Create a new Invitation
   *
   * @param  {String} eventId - id of event
   * @param  {Object[]} [invitations] - array of invitation objects
   * @return {Promise}
   */
  createInvitation(eventId, invitations = []) {
    const [ev, ep] = this.validateId(eventId, &apos;eventId&apos;);
    if (!ev) { return ep; }

    const [iv, ip] = this.validatePayload(invitations, eventInvitationSchema);
    if (!iv) { return ip; }

    const url = urlJoin(NAMESPACE, ENDPOINT_EVENT, eventId,
                                   ENDPOINT_INVITATION);

    return this.http.post(url, invitations);
  }

  /**
   * Update the status of an Invitation, by id
   *
   * @param  {String} eventId - id of event
   * @param  {String} invitationId - id of invitation
   * @param  {String} status -
   *   current RSVP status of the invitation. It may be `declined`, or `pending`
   * @return {Promise}
   */
  updateInvitationStatus(eventId, invitationId, status) {
    const [ev, ep] = this.validateId(eventId, &apos;eventId&apos;);
    if (!ev) { return ep; }

    const [iv, ip] = this.validateId(invitationId, &apos;invitationId&apos;);
    if (!iv) { return ip; }

    const [sv, sp] = this.validateStatus(status);
    if (!sv) { return sp; }

    const url = urlJoin(NAMESPACE, ENDPOINT_EVENT, eventId,
                                   ENDPOINT_INVITATION, invitationId);

    return this.http.patch(url, { status });
  }

  /**
   * Delete a specific Invitation, by id
   *
   * @param  {String} eventId - id of event
   * @param  {String} invitationId - id of invitation
   * @return {Promise}
   */
  delInvitation(eventId, invitationId) {
    const [ev, ep] = this.validateId(eventId, &apos;eventId&apos;);
    if (!ev) { return ep; }

    const [iv, ip] = this.validateId(invitationId, &apos;invitationId&apos;);
    if (!iv) { return ip; }

    const url = urlJoin(NAMESPACE, ENDPOINT_EVENT, eventId,
                                   ENDPOINT_INVITATION, invitationId);
    return this.http.delete(url);
  }

}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.5)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
